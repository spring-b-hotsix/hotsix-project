<!doctype html>
<html lang="en" data-bs-theme="auto" xmlns:th="http://www.thymeleaf.org">
<head>
    <!--    <script src="../assets/js/color-modes.js"></script>-->

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Hugo 0.115.4">
    <title>Card</title>

    <!--  jquery  -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
            crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>

    <script src="/js/card.js"></script>

    <link rel="canonical" href="https://getbootstrap.com/docs/5.3/examples/navbar-fixed/">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <!--    <link href="../assets/dist/css/bootstrap.min.css" rel="stylesheet">-->

    <style>
        .bd-placeholder-img {
            font-size: 1.125rem;
            text-anchor: middle;
            -webkit-user-select: none;
            -moz-user-select: none;
            user-select: none;
        }

        @media (min-width: 768px) {
            .bd-placeholder-img-lg {
                font-size: 3.5rem;
            }
        }

        .b-example-divider {
            width: 100%;
            height: 3rem;
            background-color: rgba(0, 0, 0, .1);
            border: solid rgba(0, 0, 0, .15);
            border-width: 1px 0;
            box-shadow: inset 0 .5em 1.5em rgba(0, 0, 0, .1), inset 0 .125em .5em rgba(0, 0, 0, .15);
        }

        .b-example-vr {
            flex-shrink: 0;
            width: 1.5rem;
            height: 100vh;
        }

        .bi {
            vertical-align: -.125em;
            fill: currentColor;
        }

        .nav-scroller {
            position: relative;
            z-index: 2;
            height: 2.75rem;
            overflow-y: hidden;
        }

        .nav-scroller .nav {
            display: flex;
            flex-wrap: nowrap;
            padding-bottom: 1rem;
            margin-top: -1px;
            overflow-x: auto;
            text-align: center;
            white-space: nowrap;
            -webkit-overflow-scrolling: touch;
        }

        .btn-bd-primary {
            --bd-violet-bg: #712cf9;
            --bd-violet-rgb: 112.520718, 44.062154, 249.437846;

            --bs-btn-font-weight: 600;
            --bs-btn-color: var(--bs-white);
            --bs-btn-bg: var(--bd-violet-bg);
            --bs-btn-border-color: var(--bd-violet-bg);
            --bs-btn-hover-color: var(--bs-white);
            --bs-btn-hover-bg: #6528e0;
            --bs-btn-hover-border-color: #6528e0;
            --bs-btn-focus-shadow-rgb: var(--bd-violet-rgb);
            --bs-btn-active-color: var(--bs-btn-hover-color);
            --bs-btn-active-bg: #5a23c8;
            --bs-btn-active-border-color: #5a23c8;
        }

        .bd-mode-toggle {
            z-index: 1500;
        }

        .modal-sheet .modal-dialog {
            width: 1000px;
            transition: bottom .75s ease-in-out;
        }

        .modal-sheet .modal-footer {
            padding-bottom: 2rem;
        }

        .icon-size {
            width: 25px;
            height: 25px;
            margin-right: 5px;
        }

        .icon-size {
            width: 25px;
            height: 25px;
            margin-right: 10px;
        }

        .btn-card-menu {
            width: 250px;
            margin-bottom: 10px;
        }

        .icon-card-menu {
            width: 20px;
            height: 20px;
            margin-right: 5px;
        }

        .image-box {
            width: 100px; /* 고정 가로 크기 */
            height: 70px; /* 고정 세로 크기 */
            overflow: hidden; /* 내용이 넘칠 경우를 대비하여 부모 요소를 자르도록 설정 */
        }

        .image-box img {
            width: 100%;
            height: 100%;
            object-fit: cover; /* 이미지를 비율을 유지하며 부모 요소에 맞게 잘라줌 */
        }

        .card-box-margin {
            margin-top: 70px;
        }
    </style>

</head>
<body style="padding-top: 3.5rem;">
<!-- 카드 상세 페이지 모달창 -->
<div class="modal fade" id="cardDetails" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <!--카드 헤더-->
                <div>
                    <div class="card-title text-decoration-none d-flex" id="card-title">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-card-heading icon-size"
                             viewBox="0 0 16 16">
                            <path d="M14.5 3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h13zm-13-1A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h13a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2h-13z"/>
                            <path d="M3 8.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5zm0-5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5v-1z"/>
                        </svg>
                        <!--디폴트-->
                        <a href="#" id="name-default" onclick="toggleName('input')"
                           style="color: inherit; text-decoration: none;">
                            <h4>
                                <b th:text="${card.body.name}"></b>
                            </h4>
                        </a>
                        <!--입력-->
                        <div id="name-input" style="display: none">
                            <input id="card-name-input" type="text" class="form-control" aria-label="card-name"
                                   aria-describedby="basic-addon1"
                                   th:value="${card.body.name}" style="width: 550px; margin-right: 130px">
                            <button type="button" class="btn btn-primary ms-auto"
                                    onclick="updateAndToggleName('default', boardId, sideId, cardId)">
                                Save
                            </button>
                        </div>
                    </div>
                    <div class="d-flex">
                        <h6 class="card-subtitle mb-2 text-body-secondary"
                            style="margin-left: 10px; margin-top: 5px; margin-right: 10px">in
                            list</h6><h6 th:text="${card.body.sideName}"></h6>
                    </div>
                </div>
                <div>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
            </div>

            <!--카드 바디 및 사이드-->
            <div class="modal-body">
                <div style="display: flex; margin-top: 10px;">
                    <!--왼쪽-->
                    <div style="width: 750px; margin-left: 30px; margin-right: 40px">
                        <div style="display: flex;">
                            <!--멤버-->
                            <div id="card-members" style="margin-right: 20px;">
                                <h6>Members</h6>
                                <div class="justify-content-end account-padding d-flex">
                                    <a href="#" class="d-block link-body-emphasis text-decoration-none"
                                       aria-expanded="false">
                                        <img src="https://vignette.wikia.nocookie.net/the-sun-vanished/images/5/5d/Twitter-avi-gender-balanced-figure.png/revision/latest?cb=20180713020754"
                                             alt="mdo" width="32" height="32" style="margin-right: 5px"
                                             class="rounded-circle">
                                    </a>
                                    <a href="#" class="d-block link-body-emphasis text-decoration-none"
                                       aria-expanded="false">
                                        <img src="https://vignette.wikia.nocookie.net/the-sun-vanished/images/5/5d/Twitter-avi-gender-balanced-figure.png/revision/latest?cb=20180713020754"
                                             alt="mdo" width="32" height="32" style="margin-right: 5px"
                                             class="rounded-circle">
                                    </a>

                                    <a href="#"
                                       class="justify-content-end d-block link-body-emphasis text-decoration-none account-padding"
                                       aria-expanded="false">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32"
                                             fill="currentColor"
                                             class="bi bi-person-add" viewBox="0 0 16 16">
                                            <path d="M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7Zm.5-5v1h1a.5.5 0 0 1 0 1h-1v1a.5.5 0 0 1-1 0v-1h-1a.5.5 0 0 1 0-1h1v-1a.5.5 0 0 1 1 0Zm-2-6a3 3 0 1 1-6 0 3 3 0 0 1 6 0ZM8 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z"/>
                                            <path d="M8.256 14a4.474 4.474 0 0 1-.229-1.004H3c.001-.246.154-.986.832-1.664C4.484 10.68 5.711 10 8 10c.26 0 .507.009.74.025.226-.341.496-.65.804-.918C9.077 9.038 8.564 9 8 9c-5 0-6 3-6 4s1 1 1 1h5.256Z"/>
                                        </svg>
                                    </a>
                                </div>
                            </div>

                            <!--라벨-->
                            <div id="card-labels" style="margin-right: 20px;">
                                <h6>Labels</h6>
                                <a class="btn" href="#" role="button"
                                   style="margin-right: 5px; background-color: #92549E; color: white"
                                   data-bs-toggle="modal"
                                   data-bs-target="#board-color">Label1</a>
                                <a class="btn" href="#" role="button"
                                   style="margin-right: 5px; background-color: #cff4fc; color: black"
                                   data-bs-toggle="modal"
                                   data-bs-target="#board-color">Label1</a>
                            </div>

                            <!-- 마감기한-->
                            <div id="card-due" th:if="${card.body.due}">
                                <h6>Due date</h6>
                                <div class="d-flex">
                                    <button id="showDueDate" type="button" class="btn btn-light"
                                            style="display: flex;"
                                            th:text="${card.body.due}" onclick="toggleDatePicker()">
                                    </button>
                                    <div th:if="${card.body.overdue}"
                                         style="background-color: red; color: white; margin-left: 10px">
                                        Overdue
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!--설명-->
                        <div id="description" class="card-box-margin">
                            <!--디폴트 상태-->
                            <div id="description-default">
                                <div style="display: flex">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor"
                                         class="bi bi-blockquote-left icon-size" viewBox="0 0 16 16">
                                        <path d="M2.5 3a.5.5 0 0 0 0 1h11a.5.5 0 0 0 0-1h-11zm5 3a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1h-6zm0 3a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1h-6zm-5 3a.5.5 0 0 0 0 1h11a.5.5 0 0 0 0-1h-11zm.79-5.373c.112-.078.26-.17.444-.275L3.524 6c-.122.074-.272.17-.452.287-.18.117-.35.26-.51.428a2.425 2.425 0 0 0-.398.562c-.11.207-.164.438-.164.692 0 .36.072.65.217.873.144.219.385.328.72.328.215 0 .383-.07.504-.211a.697.697 0 0 0 .188-.463c0-.23-.07-.404-.211-.521-.137-.121-.326-.182-.568-.182h-.282c.024-.203.065-.37.123-.498a1.38 1.38 0 0 1 .252-.37 1.94 1.94 0 0 1 .346-.298zm2.167 0c.113-.078.262-.17.445-.275L5.692 6c-.122.074-.272.17-.452.287-.18.117-.35.26-.51.428a2.425 2.425 0 0 0-.398.562c-.11.207-.164.438-.164.692 0 .36.072.65.217.873.144.219.385.328.72.328.215 0 .383-.07.504-.211a.697.697 0 0 0 .188-.463c0-.23-.07-.404-.211-.521-.137-.121-.326-.182-.568-.182h-.282a1.75 1.75 0 0 1 .118-.492c.058-.13.144-.254.257-.375a1.94 1.94 0 0 1 .346-.3z"/>
                                    </svg>
                                    <h5><b>Description</b></h5>
                                    <button type="button" class="btn btn-secondary ms-auto"
                                            onclick="toggleDescription('input')">
                                        Edit
                                    </button>
                                </div>
                                <p class="card-text" th:text="${card.body.description}"></p>
                            </div>
                            <!--입력하기-->
                            <div id="description-input" style="display: none;">
                                <div style="display: flex; margin-bottom: 20px">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor"
                                         class="bi bi-blockquote-left icon-size" viewBox="0 0 16 16">
                                        <path d="M2.5 3a.5.5 0 0 0 0 1h11a.5.5 0 0 0 0-1h-11zm5 3a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1h-6zm0 3a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1h-6zm-5 3a.5.5 0 0 0 0 1h11a.5.5 0 0 0 0-1h-11zm.79-5.373c.112-.078.26-.17.444-.275L3.524 6c-.122.074-.272.17-.452.287-.18.117-.35.26-.51.428a2.425 2.425 0 0 0-.398.562c-.11.207-.164.438-.164.692 0 .36.072.65.217.873.144.219.385.328.72.328.215 0 .383-.07.504-.211a.697.697 0 0 0 .188-.463c0-.23-.07-.404-.211-.521-.137-.121-.326-.182-.568-.182h-.282c.024-.203.065-.37.123-.498a1.38 1.38 0 0 1 .252-.37 1.94 1.94 0 0 1 .346-.298zm2.167 0c.113-.078.262-.17.445-.275L5.692 6c-.122.074-.272.17-.452.287-.18.117-.35.26-.51.428a2.425 2.425 0 0 0-.398.562c-.11.207-.164.438-.164.692 0 .36.072.65.217.873.144.219.385.328.72.328.215 0 .383-.07.504-.211a.697.697 0 0 0 .188-.463c0-.23-.07-.404-.211-.521-.137-.121-.326-.182-.568-.182h-.282a1.75 1.75 0 0 1 .118-.492c.058-.13.144-.254.257-.375a1.94 1.94 0 0 1 .346-.3z"/>
                                    </svg>
                                    <h5><b>Description</b></h5>
                                    <button type="button" class="btn btn-primary ms-auto"
                                            onclick="updateAndToggleDescription('default', boardId, sideId, cardId)">
                                        Save
                                    </button>
                                </div>
                                <textarea id="card-description-input" type="text" class="form-control"
                                          placeholder="Add a more detailed description..."
                                          aria-label="With textarea"
                                          th:text="${card.body.description}">
                </textarea>
                            </div>
                        </div>

                        <!--첨부파일-->
                        <div id="attachments" class="card-box-margin"
                             th:if="${#lists.size(card.body.attachmentList) > 0}">
                            <div id="attachments-header" style="display: flex;">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor"
                                     class="bi bi-paperclip icon-size" viewBox="0 0 16 16">
                                    <path d="M4.5 3a2.5 2.5 0 0 1 5 0v9a1.5 1.5 0 0 1-3 0V5a.5.5 0 0 1 1 0v7a.5.5 0 0 0 1 0V3a1.5 1.5 0 1 0-3 0v9a2.5 2.5 0 0 0 5 0V5a.5.5 0 0 1 1 0v7a3.5 3.5 0 1 1-7 0V3z"/>
                                </svg>
                                <h5><b>Attachments</b></h5>
                            </div>
                            <div id="attachment-list" style="margin-left: 30px;"></div>
                            <div id="attachments-body" th:each="attachment : ${card.body.attachmentList}">
                                <div id="attachments-box" style="display: flex; margin-bottom: 10px">
                                    <div id="attachment-image" style="margin-right: 10px;" class="image-box">
                                        <div class="image-wrapper">
                                            <img th:src="${attachment.source}" alt="Attachment Image">
                                        </div>
                                    </div>
                                    <div id="attachment-box">
                                        <!--디폴트-->
                                        <a id="attachment-file-name-default">
                                            <b>
                                                <b th:text="${attachment.fileName}"></b>
                                            </b>
                                        </a>

                                        <!--파일명 수정-->
                                        <div id="attachment-file-name-update" style="display: none">
                                            <input id="attachment-file-name-input" type="text" class="form-control"
                                                   aria-label="attachment-name"
                                                   aria-describedby="basic-addon1"
                                                   th:value="${attachment.fileName}" style="margin-right: 130px">
                                            <button type="button" class="btn btn-primary ms-auto"
                                                    th:value="${attachment.fileId}"
                                                    onclick="updateAndtoggleAttachmentName('default', boardId, sideId, cardId, this.value)">
                                                Save
                                            </button>
                                        </div>

                                        <!--파일 올린 시간-->
                                        <div style="display: flex">
                                            <div style="display: flex; margin-right: 20px">Added
                                                <span th:text="${#temporals.format(attachment.createdAt, 'yyyy-MM-dd HH:mm:ss')}"
                                                      class="formattedDate" style="display: none;"></span>
                                                <span class="relativeTime" style="margin-left: 10px"></span>
                                            </div>

                                            <!--파일 수정 클릭-->
                                            <a href="#" class="text-secondary" style="margin-right: 10px"
                                               onclick="toggleAttachmentName('input')">Edit</a>

                                            <!--파일 삭제 클릭-->
                                            <a href="#" class="text-secondary" style="margin-right: 10px"
                                               data-bs-toggle="modal"
                                               data-bs-target="#attachment-delete-modal">Delete</a>
                                        </div>
                                    </div>
                                </div>

                                <!--첨부파일 삭제 확인 모달-->
                                <div class="modal fade" id="attachment-delete-modal" tabindex="-1"
                                     aria-labelledby="exampleModalLabel" aria-hidden="true">
                                    <div class="modal-dialog">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h1 class="modal-title fs-5">Delete</h1>
                                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                        aria-label="Close"></button>
                                            </div>
                                            <div class="modal-body">
                                                <b style="margin-right: 10px" th:text="${attachment.fileName}"></b>
                                                첨부파일을 삭제하시겠습니까?
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-danger"
                                                        th:value="${attachment.fileId}"
                                                        onclick="deleteAttachment(boardId, sideId, cardId, this.value)">
                                                    Delete
                                                </button>
                                                <button type="button" class="btn btn-secondary"
                                                        data-bs-dismiss="modal">
                                                    Close
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="attachments-footer" style="display: flex; margin-left: 30px; margin-top: 10px">
                                <button type="button" class="btn btn-secondary" data-bs-toggle="modal"
                                        data-bs-target="#attachment-add">
                                    Add an attachment
                                </button>
                            </div>
                        </div>

                        <!--체크리스트-->
                        <div id="checklist" class="card-box-margin"
                             th:if="${#lists.size(card.body.checklistList) > 0}">
                            <th:block th:each="checklist: ${card.body.checklistList}">
                                <div style="margin-bottom: 20px">
                                    <div id="checklist-header">
                                        <!--체크리스트 이름 디폴트-->
                                        <div id="checklist-name-default">
                                            <div class="d-flex justify-content-between">
                                                <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor"
                                                     class="bi bi-check2-square icon-size" viewBox="0 0 16 16">
                                                    <path d="M3 14.5A1.5 1.5 0 0 1 1.5 13V3A1.5 1.5 0 0 1 3 1.5h8a.5.5 0 0 1 0 1H3a.5.5 0 0 0-.5.5v10a.5.5 0 0 0 .5.5h10a.5.5 0 0 0 .5-.5V8a.5.5 0 0 1 1 0v5a1.5 1.5 0 0 1-1.5 1.5H3z"/>
                                                    <path d="m8.354 10.354 7-7a.5.5 0 0 0-.708-.708L8 9.293 5.354 6.646a.5.5 0 1 0-.708.708l3 3a.5.5 0 0 0 .708 0z"/>
                                                </svg>
                                                <h5 onclick="toggleChecklistName('input')"><b
                                                        th:text="${checklist.name}"></b></h5>
                                                <!--체크리스트 삭제 버튼-->
                                                <button type="button" class="btn btn-secondary ms-auto"
                                                        data-bs-toggle="modal"
                                                        data-bs-target="#checklist-delete-modal">
                                                    Delete
                                                </button>
                                            </div>
                                        </div>

                                        <!--체크리스트 이름 수정 입력-->
                                        <div id="checklist-name-input" style="display: none">
                                            <div style="display: flex; margin-bottom: 20px">
                                                <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor"
                                                     class="bi bi-check2-square icon-size" viewBox="0 0 16 16">
                                                    <path d="M3 14.5A1.5 1.5 0 0 1 1.5 13V3A1.5 1.5 0 0 1 3 1.5h8a.5.5 0 0 1 0 1H3a.5.5 0 0 0-.5.5v10a.5.5 0 0 0 .5.5h10a.5.5 0 0 0 .5-.5V8a.5.5 0 0 1 1 0v5a1.5 1.5 0 0 1-1.5 1.5H3z"/>
                                                    <path d="m8.354 10.354 7-7a.5.5 0 0 0-.708-.708L8 9.293 5.354 6.646a.5.5 0 1 0-.708.708l3 3a.5.5 0 0 0 .708 0z"/>
                                                </svg>
                                                <input id="checklist-name-update-input" type="text"
                                                       class="form-control"
                                                       aria-label="checklist-name"
                                                       aria-describedby="basic-addon1"
                                                       th:value="${checklist.name}"
                                                       style="width: 550px; margin-right: 130px">
                                                <button type="button" class="btn btn-primary ms-auto"
                                                        th:value="${checklist.checklistId}"
                                                        onclick="updateAndToggleChecklistName('default', boardId, sideId, cardId, this.value)">
                                                    Save
                                                </button>
                                            </div>
                                        </div>

                                        <!--체크리스트 삭제 확인 모달-->
                                        <div class="modal fade" id="checklist-delete-modal" tabindex="-1"
                                             aria-labelledby="exampleModalLabel" aria-hidden="true">
                                            <div class="modal-dialog">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h1 class="modal-title fs-5">Delete</h1>
                                                        <button type="button" class="btn-close"
                                                                data-bs-dismiss="modal"
                                                                aria-label="Close"></button>
                                                    </div>
                                                    <div class="modal-body">
                                                        <b style="margin-right: 10px"
                                                           th:text="${checklist.name}"></b>
                                                        체크리스트를 삭제하시겠습니까?
                                                    </div>
                                                    <div class="modal-footer">
                                                        <button type="button" class="btn btn-danger"
                                                                th:value="${checklist.checklistId}"
                                                                onclick="deleteChecklist(boardId, sideId, cardId, this.getAttribute('value'))">
                                                            Delete
                                                        </button>
                                                        <button type="button" class="btn btn-secondary"
                                                                data-bs-dismiss="modal">
                                                            Close
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!--체크리스트 아이템 조회-->
                                    <div id="items" style="margin-left: 5px"
                                         th:if="${#lists.size(checklist.checklistItems) > 0}"
                                         th:each="item : ${checklist.checklistItems}">
                                        <div class="form-check d-flex" style="margin-bottom: 10px">
                                            <input class="form-check-input" type="checkbox"
                                                   style="margin-right: 5px"
                                                   th:data-checklist-id="${checklist.checklistId}"
                                                   th:data-item-id="${item.itemId}"
                                                   th:checked="${item.checked}"
                                                   onclick="updateCheckboxState(boardId, sideId, cardId, this.getAttribute('data-checklist-id'), this.getAttribute('data-item-id'), this.checked)">
                                            <!--아이템 이름 디폴트-->
                                            <div id="item-content-default">
                                                <div class="d-flex">
                                                    <h6 class="form-check-label" th:text="${item.content}"></h6>
                                                    <!--아이템 내용 수정 클릭-->
                                                    <a href="#" class="text-secondary" style="margin-left: 10px"
                                                       onclick="toggleItemContent('input')">Edit</a>
                                                    <!--아이템 삭제 클릭-->
                                                    <a href="#" class="text-secondary" style="margin-left: 10px"
                                                       data-bs-toggle="modal"
                                                       data-bs-target="#item-delete-modal">Delete</a>

                                                </div>
                                            </div>
                                        </div>
                                        <!--아이템 내용 수정-->
                                        <div id="item-content-update" style="display: none">
                                            <input id="item-content-input" type="text" class="form-control"
                                                   aria-label="item-content"
                                                   aria-describedby="basic-addon1"
                                                   th:value="${item.content}" style="margin-right: 130px">
                                            <button type="button" class="btn btn-primary ms-auto"
                                                    th:value="${item.content}"
                                                    th:data-checklist-id="${checklist.checklistId}"
                                                    th:data-item-id="${item.itemId}"
                                                    onclick="updateAndtoggleItemContent('default', boardId, sideId, cardId, this.getAttribute('data-checklist-id'), this.getAttribute('data-item-id'), this.getAttribute('value'))">
                                                Save
                                            </button>
                                        </div>
                                        <!--아이템 삭제 확인 모달-->
                                        <div class="modal fade" id="item-delete-modal" tabindex="-1"
                                             aria-labelledby="exampleModalLabel" aria-hidden="true">
                                            <div class="modal-dialog">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h1 class="modal-title fs-5">Delete</h1>
                                                        <button type="button" class="btn-close"
                                                                data-bs-dismiss="modal"
                                                                aria-label="Close"></button>
                                                    </div>
                                                    <div class="modal-body">
                                                        <b style="margin-right: 10px" th:text="${item.content}"></b>
                                                        아이템을 삭제하시겠습니까?
                                                    </div>
                                                    <div class="modal-footer">
                                                        <button type="button" class="btn btn-danger"
                                                                th:data-checklist-id="${checklist.checklistId}"
                                                                th:data-item-id="${item.itemId}"
                                                                onclick="deleteItem(boardId, sideId, cardId, this.getAttribute('data-checklist-id'), this.getAttribute('data-item-id'))">
                                                            Delete
                                                        </button>
                                                        <button type="button" class="btn btn-secondary"
                                                                data-bs-dismiss="modal">
                                                            Close
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!--체크리스트 아이템 생성-->
                                    <div id="checklist-footer"
                                         style="display: flex; margin-left: 30px; margin-top: 10px">
                                        <button type="button" class="btn btn-secondary"
                                                data-bs-toggle="modal" data-bs-target="#item-add">
                                            Add an item
                                        </button>
                                    </div>

                                    <!--체크리스트 아이템 생성 모달창-->
                                    <div class="modal fade" id="item-add" tabindex="-1"
                                         aria-labelledby="exampleModalLabel"
                                         aria-hidden="true">
                                        <div class="modal-dialog">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h1 class="modal-title fs-5">Add checklist</h1>
                                                    <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                            aria-label="Close"></button>
                                                </div>
                                                <div class="modal-body">
                                                    <div class="input-group">
                                                        <input id="card-checklist-item-input" type="text"
                                                               class="form-control"
                                                               placeholder="Add an item..."
                                                               aria-label="user-invite"
                                                               aria-describedby="basic-addon1">
                                                    </div>
                                                </div>
                                                <div class="modal-footer">
                                                    <button type="button" class="btn btn-secondary"
                                                            data-bs-dismiss="modal">
                                                        Cancel
                                                    </button>
                                                    <button type="button" class="btn btn-primary"
                                                            th:value="${checklist.checklistId}"
                                                            onclick="addItem(boardId, sideId, cardId, this.getAttribute('value'))"
                                                            data-bs-dismiss="modal">Add
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </th:block>
                        </div>

                        <!--댓글-->
                        <div id="comment" class="card-box-margin">
                            <div id="comment-header" style="display: flex;">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor"
                                     class="bi bi-chat-left-quote icon-size" viewBox="0 0 16 16">
                                    <path d="M14 1a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H4.414A2 2 0 0 0 3 11.586l-2 2V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12.793a.5.5 0 0 0 .854.353l2.853-2.853A1 1 0 0 1 4.414 12H14a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/>
                                    <path d="M7.066 4.76A1.665 1.665 0 0 0 4 5.668a1.667 1.667 0 0 0 2.561 1.406c-.131.389-.375.804-.777 1.22a.417.417 0 1 0 .6.58c1.486-1.54 1.293-3.214.682-4.112zm4 0A1.665 1.665 0 0 0 8 5.668a1.667 1.667 0 0 0 2.561 1.406c-.131.389-.375.804-.777 1.22a.417.417 0 1 0 .6.58c1.486-1.54 1.293-3.214.682-4.112z"/>
                                </svg>
                                <h5><b>Comment</b></h5>
                            </div>
                            <div id="comments" style="margin-left: 5px">
                                <div id="comment-input" style="display: flex; margin-bottom: 10px; margin-top: 5px">
                                    <div class="d-block link-body-emphasis text-decoration-none"
                                         aria-expanded="false">
                                        <img src="https://vignette.wikia.nocookie.net/the-sun-vanished/images/5/5d/Twitter-avi-gender-balanced-figure.png/revision/latest?cb=20180713020754"
                                             alt="mdo" width="32" height="32" style="margin-right: 10px"
                                             class="rounded-circle">
                                    </div>
                                    <div class="input-group input-group-sm mb-3" style="margin-right: 10px">
                                        <input id="card-comment-input" type="text" class="form-control"
                                               placeholder="Write a comment..."
                                               aria-label="Write a comment" aria-describedby="inputGroup-sizing-sm"
                                               style="font-size: 15px">
                                    </div>
                                    <!--댓글 추가-->
                                    <div id="comment-save" style="margin-left: 10px; margin-top: -5px">
                                        <button type="button" class="btn btn-secondary"
                                                onclick="addComment(boardId, sideId, cardId)">
                                            Save
                                        </button>
                                    </div>
                                </div>
                                <!--댓글 조회-->
                                <div id="comments-get">
                                    <th:block th:each="comment: ${card.body.commentList}">
                                        <div id="comment-box" style="margin-bottom: 20px; margin-right: 80px;">
                                            <div id="comment-box-header" style="display: flex; margin-bottom: -5px">
                                                <div id="comment-user-image"
                                                     class="d-block link-body-emphasis text-decoration-none"
                                                     aria-expanded="false">
                                                    <img src="https://vignette.wikia.nocookie.net/the-sun-vanished/images/5/5d/Twitter-avi-gender-balanced-figure.png/revision/latest?cb=20180713020754"
                                                         alt="mdo" width="32" height="32" style="margin-right: 10px"
                                                         class="rounded-circle">
                                                </div>
                                                <!--댓글 작성자 닉네임-->
                                                <div id="comment-user-nickname">
                                                    <b th:text="${comment.nickname}"></b>
                                                </div>
                                                <!--댓글 작성 시간-->
                                                <div id="comment-createa-at" class="text-secondary"
                                                     style="margin-left: 10px; font-size: 14px">
                                   <span th:text="${#temporals.format(comment.createdAt, 'yyyy-MM-dd HH:mm:ss')}"
                                         class="formattedDate" style="display: none;"></span>
                                                    <span class="relativeTime" style="margin-left: 10px"></span>
                                                </div>
                                            </div>
                                            <!--댓글 조회 디폴트-->
                                            <div id="comment-box-content">
                                                <a id="comment-content-default" type="text" class="form-control"
                                                   style="font-size: 15px; margin-left: 40px; margin-bottom: 5px; width: 625px; text-decoration: none;"
                                                   th:text="${comment.content}">
                                                </a>
                                            </div>

                                            <!--댓글 수정-->
                                            <div id="comment-content-update" style="display: none">
                                                <input id="comment-content-input" type="text" class="form-control"
                                                       aria-label="Update a comment"
                                                       aria-describedby="inputGroup-sizing-sm"
                                                       style="font-size: 15px; margin-left: 40px;"
                                                       th:value="${comment.content}">
                                                <button type="button" class="btn btn-primary ms-auto"
                                                        th:value="${comment.commentId}"
                                                        onclick="updateAndToggleCommentContent('default', boardId, sideId, cardId, this.getAttribute('value'))">
                                                    Save
                                                </button>
                                            </div>

                                            <div id="comment-box-footer" style="display: flex; margin-left: 45px;">
                                                <!--댓글 수정 클릭-->
                                                <a href="#" class="text-secondary" style="margin-right: 10px"
                                                   onclick="toggleComment('input')">Edit</a>
                                                <!--댓글 삭제 클릭-->
                                                <a href="#" class="text-secondary" style="margin-right: 10px"
                                                   data-bs-toggle="modal"
                                                   data-bs-target="#comment-delete-modal">Delete</a>
                                            </div>
                                        </div>

                                        <!--댓글 삭제 확인 모달-->
                                        <div class="modal fade" id="comment-delete-modal" tabindex="-1"
                                             aria-labelledby="exampleModalLabel" aria-hidden="true">
                                            <div class="modal-dialog">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h1 class="modal-title fs-5">Delete</h1>
                                                        <button type="button" class="btn-close"
                                                                data-bs-dismiss="modal"
                                                                aria-label="Close"></button>
                                                    </div>
                                                    <div class="modal-body">
                                                        <b style="margin-right: 10px"></b>
                                                        댓글을 삭제하시겠습니까?
                                                    </div>
                                                    <div class="modal-footer">
                                                        <button type="button" class="btn btn-danger"
                                                                th:value="${comment.commentId}"
                                                                onclick="deleteComment(boardId, sideId, cardId, this.getAttribute('value'))">
                                                            Delete
                                                        </button>
                                                        <button type="button" class="btn btn-secondary"
                                                                data-bs-dismiss="modal">
                                                            Close
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </th:block>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!--오른쪽 메뉴-->
                    <div style="width: 250px">
                        <div id="card-menu-add-to-card">
                            <h6>Add to card</h6>

                            <!--멤버-->
                            <button type="button" class="btn btn-secondary btn-card-menu text-start">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor"
                                     class="bi bi-person icon-card-menu" viewBox="0 0 16 16">
                                    <path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6Zm2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0Zm4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4Zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10Z"/>
                                </svg>
                                Members
                            </button>

                            <!--라벨-->
                            <button type="button" class="btn btn-secondary btn-card-menu text-start">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor"
                                     class="bi bi-tag icon-card-menu" viewBox="0 0 16 16">
                                    <path d="M6 4.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm-1 0a.5.5 0 1 0-1 0 .5.5 0 0 0 1 0z"/>
                                    <path d="M2 1h4.586a1 1 0 0 1 .707.293l7 7a1 1 0 0 1 0 1.414l-4.586 4.586a1 1 0 0 1-1.414 0l-7-7A1 1 0 0 1 1 6.586V2a1 1 0 0 1 1-1zm0 5.586 7 7L13.586 9l-7-7H2v4.586z"/>
                                </svg>
                                Labels
                            </button>

                            <!--체크리스트-->
                            <button type="button" class="btn btn-secondary btn-card-menu text-start"
                                    data-bs-toggle="modal"
                                    data-bs-target="#checklist-add">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor"
                                     class="bi bi-check2-square icon-card-menu" viewBox="0 0 16 16">
                                    <path d="M3 14.5A1.5 1.5 0 0 1 1.5 13V3A1.5 1.5 0 0 1 3 1.5h8a.5.5 0 0 1 0 1H3a.5.5 0 0 0-.5.5v10a.5.5 0 0 0 .5.5h10a.5.5 0 0 0 .5-.5V8a.5.5 0 0 1 1 0v5a1.5 1.5 0 0 1-1.5 1.5H3z"/>
                                    <path d="m8.354 10.354 7-7a.5.5 0 0 0-.708-.708L8 9.293 5.354 6.646a.5.5 0 1 0-.708.708l3 3a.5.5 0 0 0 .708 0z"/>
                                </svg>
                                Checklist
                            </button>

                            <!--마감기한-->
                            <div class="container" style="margin-left: -10px">
                                <button id="showDatePicker" type="button"
                                        class="btn btn-secondary btn-card-menu text-start"
                                        onclick="toggleDatePicker()">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor"
                                         class="bi bi-clock icon-card-menu" viewBox="0 0 16 16">
                                        <path d="M8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71V3.5z"/>
                                        <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm7-8A7 7 0 1 1 1 8a7 7 0 0 1 14 0z"/>
                                    </svg>
                                    Dates
                                </button>
                                <div id="datePickerContainer" style="display: none;">
                                    <input type="datetime-local" id="dateTimePicker" class="form-control"
                                           style="margin-top: 5px">
                                    <div class="d-flex"
                                         style="margin-left: 90px; margin-top: 10px; margin-bottom: 10px;">
                                        <button id="deleteDue-btn" class="btn btn-danger mt-2"
                                                data-bs-toggle="modal"
                                                data-bs-target="#due-delete-modal"
                                                style="margin-right: 15px"
                                        >Delete
                                        </button>
                                        <button id="selectDateTime" class="btn btn-primary mt-2"
                                                onclick="selectDateTime(boardId, sideId, cardId)">Select
                                        </button>
                                    </div>
                                </div>
                                <!--마감기한 삭제 확인 모달-->
                                <div class="modal fade" id="due-delete-modal" tabindex="-1"
                                     aria-labelledby="exampleModalLabel" aria-hidden="true">
                                    <div class="modal-dialog">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h1 class="modal-title fs-5">Delete</h1>
                                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                        aria-label="Close"></button>
                                            </div>
                                            <div class="modal-body">
                                                <b style="margin-right: 10px"></b>
                                                마감기한을 삭제하시겠습니까?
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-danger"
                                                        onclick="deleteDue(boardId, sideId, cardId)">
                                                    Delete
                                                </button>
                                                <button type="button" class="btn btn-secondary"
                                                        data-bs-dismiss="modal">
                                                    Close
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!--첨부파일-->
                            <button type="button" class="btn btn-secondary btn-card-menu text-start"
                                    data-bs-toggle="modal" data-bs-target="#attachment-add">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor"
                                     class="bi bi-paperclip icon-card-menu" viewBox="0 0 16 16">
                                    <path d="M4.5 3a2.5 2.5 0 0 1 5 0v9a1.5 1.5 0 0 1-3 0V5a.5.5 0 0 1 1 0v7a.5.5 0 0 0 1 0V3a1.5 1.5 0 1 0-3 0v9a2.5 2.5 0 0 0 5 0V5a.5.5 0 0 1 1 0v7a3.5 3.5 0 1 1-7 0V3z"/>
                                </svg>
                                Attachment
                            </button>
                        </div>

                        <!--첨부파일 추가 모달창-->
                        <div class="modal fade" id="attachment-add" tabindex="-1"
                             aria-labelledby="exampleModalLabel"
                             aria-hidden="true">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h1 class="modal-title fs-5">Add an attachment</h1>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        <div class="input-group">
                                            <input type="file" class="form-control" id="card-attachment-input"
                                                   aria-describedby="inputGroupFileAddon04" aria-label="Upload">
                                        </div>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                                            Close
                                        </button>
                                        <button type="button" class="btn btn-primary"
                                                onclick="addAttachment(boardId, sideId, cardId)"
                                                data-bs-dismiss="modal">Add
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!--체크리스트 생성 모달창-->
                        <div class="modal fade" id="checklist-add" tabindex="-1" aria-labelledby="exampleModalLabel"
                             aria-hidden="true">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h1 class="modal-title fs-5">Add checklist</h1>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        <div class="input-group">
                                            <input id="card-checklist-input" type="text" class="form-control"
                                                   placeholder="Enter checklist title..."
                                                   aria-label="user-invite" aria-describedby="basic-addon1">
                                        </div>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                                            Close
                                        </button>
                                        <button type="button" class="btn btn-primary"
                                                onclick="addChecklist(boardId, sideId, cardId)"
                                                data-bs-dismiss="modal">Add
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>


                        <div id="card-menu-actions" style="margin-top: 20px">
                            <h6>Actions</h6>

                            <!--이동-->
                            <button type="button" class="btn btn-secondary btn-card-menu text-start">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor"
                                     class="bi bi-arrow-right icon-card-menu" viewBox="0 0 16 16">
                                    <path fill-rule="evenodd"
                                          d="M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8z"/>
                                </svg>
                                Move
                            </button>

                            <!--삭제-->
                            <button type="button" class="btn btn-secondary btn-card-menu text-start">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor"
                                     class="bi bi-bag-x icon-card-menu" viewBox="0 0 16 16">
                                    <path fill-rule="evenodd"
                                          d="M6.146 8.146a.5.5 0 0 1 .708 0L8 9.293l1.146-1.147a.5.5 0 1 1 .708.708L8.707 10l1.147 1.146a.5.5 0 0 1-.708.708L8 10.707l-1.146 1.147a.5.5 0 0 1-.708-.708L7.293 10 6.146 8.854a.5.5 0 0 1 0-.708z"/>
                                    <path d="M8 1a2.5 2.5 0 0 1 2.5 2.5V4h-5v-.5A2.5 2.5 0 0 1 8 1zm3.5 3v-.5a3.5 3.5 0 1 0-7 0V4H1v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V4h-3.5zM2 5h12v9a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V5z"/>
                                </svg>
                                Delete
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!--카드 푸터-->
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<!--<script src="../assets/dist/js/bootstrap.bundle.min.js"></script>-->
<script th:inline="javascript">
    var boardId = /*[[ ${boardId} ]]*/ 0;
    var sideId = /*[[ ${sideId} ]]*/ 0;
    var cardId = /*[[ ${cardId} ]]*/ 0;

    <!--상대 시간 표시-->
    const formattedDateElements = document.querySelectorAll('.formattedDate');
    formattedDateElements.forEach(element => {
        const formattedDate = element.textContent;
        const relativeTime = moment(formattedDate).fromNow();
        const relativeTimeElement = element.nextElementSibling;
        relativeTimeElement.textContent = relativeTime;
    });

    <!--마감 기한 날짜 선택-->
    function toggleDatePicker() {
        const datePickerContainer = document.getElementById('datePickerContainer');
        datePickerContainer.style.display = datePickerContainer.style.display === 'none' ? 'block' : 'none';
    }

    function selectDateTime(boardId, sideId, cardId) {
        const dateTimePicker = document.getElementById('dateTimePicker');
        const selectedDateTime = new Date(dateTimePicker.value);
        const requestDto = {
            due: selectedDateTime
        };

        fetch(`/boards/${boardId}/sides/${sideId}/cards/${cardId}/due`, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(requestDto)
        })
            .then(function (response) {
                return response.json();
            })
            .then(function (responseDto) {
                alert("마감기한 설정 완료!");

                // 모달 내용을 업데이트한 후 창을 새로고침
                location.reload();
            });
    }
</script>
</body>
</html>
